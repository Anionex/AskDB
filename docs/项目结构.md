# AskDB é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ å½“å‰é¡¹ç›®ç»“æ„ï¼ˆAgno ç‰ˆæœ¬ï¼‰

```
askdb/
â”œâ”€â”€ askdb_agno.py              # ä¸»ç¨‹åºå…¥å£ï¼ˆAgno æ¡†æ¶ç‰ˆæœ¬ï¼‰
â”œâ”€â”€ requirements.txt           # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ .env.example              # ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹ï¼ˆéœ€å¤åˆ¶ä¸º.envï¼‰
â”œâ”€â”€ .gitignore                # Git å¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ test_agno_implementation.py # åŠŸèƒ½æµ‹è¯•è„šæœ¬
â”œâ”€â”€ README.md                 # é¡¹ç›®è¯´æ˜ï¼ˆè‹±æ–‡åŸç‰ˆï¼‰
â”œâ”€â”€ README_AGNO.md            # Agno ç‰ˆæœ¬è¯¦ç»†è¯´æ˜ï¼ˆä¸­æ–‡ï¼‰
â”œâ”€â”€ ä½¿ç”¨è¯´æ˜.md                # å¿«é€Ÿä½¿ç”¨æŒ‡å—ï¼ˆä¸­æ–‡ï¼‰
â”œâ”€â”€ é¡¹ç›®ç»“æ„.md                # æœ¬æ–‡ä»¶
â”‚
â”œâ”€â”€ lib/                      # æ ¸å¿ƒåº“æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ safety.py            # å®‰å…¨ç®¡ç†å™¨ï¼ˆå¤šå±‚å®‰å…¨åè®®ï¼‰
â”‚
â”œâ”€â”€ tools/                    # å·¥å…·æ¨¡å—ï¼ˆAgnoå·¥å…·é›† + åº•å±‚æ”¯æŒï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agno_tools.py        # â­ Agno å·¥å…·é›†ï¼ˆæ ¸å¿ƒå®ç°ï¼‰
â”‚   â”œâ”€â”€ database.py          # æ•°æ®åº“åº•å±‚æ“ä½œï¼ˆæ”¯æŒæ¨¡å—ï¼‰
â”‚   â”œâ”€â”€ schema.py            # æ¨¡å¼ç®¡ç†å’Œå‘é‡ç´¢å¼•ï¼ˆæ”¯æŒæ¨¡å—ï¼‰
â”‚   â””â”€â”€ web_search.py        # ç½‘ç»œæœç´¢å·¥å…·ï¼ˆæ”¯æŒæ¨¡å—ï¼‰
â”‚
â”œâ”€â”€ archive/                  # å½’æ¡£ç›®å½•ï¼ˆå·²å¼ƒç”¨çš„åŸç‰ˆå®ç°ï¼‰
â”‚   â””â”€â”€ legacy_implementation/
â”‚       â”œâ”€â”€ main.py          # åŸç‰ˆä¸»ç¨‹åº
â”‚       â”œâ”€â”€ core.py          # åŸç‰ˆ Agent å®ç°
â”‚       â”œâ”€â”€ prompting.py     # åŸç‰ˆæç¤ºç®¡ç†
â”‚       â”œâ”€â”€ models/          # åŸç‰ˆ LLM æ¥å£
â”‚       â”œâ”€â”€ config/          # åŸç‰ˆé…ç½®ç³»ç»Ÿ
â”‚       â”œâ”€â”€ utils/           # åŸç‰ˆå·¥å…·å‡½æ•°
â”‚       â””â”€â”€ tests/           # åŸç‰ˆæµ‹è¯•æ–‡ä»¶
â”‚
â”œâ”€â”€ logs/                     # æ—¥å¿—æ–‡ä»¶ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼Œgitå¿½ç•¥ï¼‰
â”œâ”€â”€ cache/                    # ç¼“å­˜ç›®å½•ï¼ˆgitå¿½ç•¥ï¼‰
â””â”€â”€ data/                     # æ•°æ®æ–‡ä»¶ç›®å½•ï¼ˆgitå¿½ç•¥ï¼‰
```

## ğŸ“‹ æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### ä¸»ç¨‹åº

**askdb_agno.py**
- Agno æ¡†æ¶å®ç°çš„ä¸»ç¨‹åº
- åŒ…å«æ‰€æœ‰ CLI å‘½ä»¤ï¼šinteractive, ask, status, describe, setup
- çº¦ 500 è¡Œä»£ç ï¼Œæ¯”åŸç‰ˆå‡å°‘ 70%
- å®Œæ•´å®ç°è®ºæ–‡è¦æ±‚çš„æ‰€æœ‰åŠŸèƒ½

### å·¥å…·é›†

**tools/agno_tools.py** 
- `DatabaseTools` - æ•°æ®åº“å·¥å…·é›†
  - `execute_query` - æ‰§è¡Œ SELECT æŸ¥è¯¢
  - `execute_non_query` - æ‰§è¡Œæ•°æ®ä¿®æ”¹æ“ä½œ
  - `list_tables` - åˆ—å‡ºæ‰€æœ‰è¡¨
  - `describe_table` - è·å–è¡¨ç»“æ„
  - `search_tables_by_name` - è¯­ä¹‰è¡¨æœç´¢ï¼ˆåŸºäºå‘é‡ï¼‰
  
- `WebSearchTools` - ç½‘ç»œæœç´¢å·¥å…·é›†
  - `request_for_internet_search` - äº’è”ç½‘æœç´¢

- `DatabaseConnection` - æ•°æ®åº“è¿æ¥ç®¡ç†
  - è‡ªåŠ¨è¿æ¥ç®¡ç†
  - é›†æˆå®‰å…¨æ£€æŸ¥
  - æ”¯æŒå¤šç§æ•°æ®åº“

**tools/database.py**
- æ•°æ®åº“åº•å±‚æ“ä½œå°è£…
- SQLAlchemy é›†æˆ
- æ”¯æŒ MySQLã€PostgreSQLã€SQLite

**tools/schema.py**
- æ•°æ®åº“æ¨¡å¼æ¢ç´¢
- å‘é‡ç´¢å¼•æ„å»ºï¼ˆsentence-transformersï¼‰
- è¯­ä¹‰æœç´¢åŠŸèƒ½

**tools/web_search.py**
- ç½‘ç»œæœç´¢å®ç°
- æ”¯æŒ DuckDuckGoã€Googleã€Bing
- å¼‚æ­¥æœç´¢æ”¯æŒ

### å®‰å…¨æ¨¡å—

**agent/safety.py**
- é£é™©åˆ†ç±»ï¼ˆLOW/MEDIUM/HIGH/CRITICALï¼‰
- PII æ£€æµ‹ï¼ˆé‚®ç®±ã€ç”µè¯ã€SSN ç­‰ï¼‰
- SQL æ³¨å…¥æ£€æµ‹
- æŸ¥è¯¢å¤æ‚åº¦è¯„ä¼°
- ç”¨æˆ·ç¡®è®¤æœºåˆ¶

### é…ç½®æ¨¡å—

**config/**
- åº”ç”¨é…ç½®ç®¡ç†
- æ•°æ®åº“è¿æ¥é…ç½®
- LLM é…ç½®ï¼ˆè™½ç„¶ç°åœ¨ä½¿ç”¨ Agnoï¼‰

### æµ‹è¯•ä¸æ–‡æ¡£

**test_agno_implementation.py**
- å®Œæ•´çš„åŠŸèƒ½æµ‹è¯•å¥—ä»¶
- éªŒè¯æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½
- ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š

**README_AGNO.md**
- è¯¦ç»†çš„ä¸­æ–‡æ–‡æ¡£
- ä½¿ç”¨æŒ‡å—å’Œç¤ºä¾‹
- å¸¸è§é—®é¢˜è§£ç­”

**ä½¿ç”¨è¯´æ˜.md**
- å¿«é€Ÿå¼€å§‹æŒ‡å—
- é…ç½®æ­¥éª¤
- åŠŸèƒ½å¯¹æ¯”è¡¨

## ğŸ—‘ï¸ å·²æ¸…ç†çš„æ–‡ä»¶

### ç§»è‡³ `archive/legacy_implementation/` çš„æ–‡ä»¶ï¼š

**åŸç‰ˆæ ¸å¿ƒå®ç°**ï¼ˆå·²è¢« Agno ç‰ˆæœ¬æ›¿ä»£ï¼‰ï¼š
1. **main.py** - åŸç‰ˆä¸»ç¨‹åº â†’ æ–°ç‰ˆ: `askdb_agno.py`
2. **agent/core.py** - åŸç‰ˆ ReAct å®ç° â†’ Agno æ¡†æ¶å†…ç½®
3. **agent/prompting.py** - åŸç‰ˆæç¤ºç®¡ç† â†’ Agno å†…ç½®
4. **models/** - åŸç‰ˆ LLM æ¥å£ â†’ Agno ç›´æ¥é›†æˆ Gemini
   - llm_interface.py
   - conversation.py

**é…ç½®å’Œå·¥å…·æ¨¡å—**ï¼ˆAgno ç‰ˆæœ¬å·²ç®€åŒ–ï¼‰ï¼š
5. **config/** - åŸç‰ˆé…ç½®ç³»ç»Ÿ â†’ ç°åœ¨ä½¿ç”¨ç¯å¢ƒå˜é‡
   - settings.py
   - database_configs.py
6. **utils/** - åŸç‰ˆå·¥å…·å‡½æ•° â†’ Agno ç‰ˆæœ¬ä¸éœ€è¦
   - helpers.py (1000+ è¡Œï¼Œæœªè¢«ä½¿ç”¨)
   - logging.py (400+ è¡Œï¼Œæœªè¢«ä½¿ç”¨)
7. **tests/** - åŸç‰ˆæµ‹è¯•æ–‡ä»¶ â†’ æ–°ç‰ˆ: `test_agno_implementation.py`
   - test_agent.py
   - test_safety.py
   - test_tools.py

### å·²åˆ é™¤çš„æ–‡ä»¶ï¼š
- **ä¿®æ”¹è®¡åˆ’.md** - ä»»åŠ¡å·²å®Œæˆ
- **nul, nul~** - ä¸´æ—¶æ–‡ä»¶
- **__pycache__/** - Python ç¼“å­˜ç›®å½•

### é¡¹ç›®ä¼˜åŒ–ç»“æœï¼š
- æ ¸å¿ƒä»£ç ä» ~5000 è¡Œå‡å°‘åˆ° ~3000 è¡Œ
- ä¸»ç¨‹åºä» 656 è¡Œå‡å°‘åˆ° ~500 è¡Œ
- ç§»é™¤äº† 1500+ è¡Œæœªä½¿ç”¨çš„å·¥å…·å‡½æ•°
- ç®€åŒ–äº†é…ç½®ç³»ç»Ÿï¼Œä½¿ç”¨ç¯å¢ƒå˜é‡ä»£æ›¿

## ğŸ”„ ä¾èµ–å…³ç³»

```
askdb_agno.py
    â”œâ”€â†’ agno (æ¡†æ¶)
    â”‚   â”œâ”€â†’ Agent
    â”‚   â”œâ”€â†’ Gemini
    â”‚   â””â”€â†’ Toolkit
    â”‚
    â””â”€â†’ tools/agno_tools.py
        â”œâ”€â†’ DatabaseConnection
        â”‚   â”œâ”€â†’ tools/database.py
        â”‚   â”œâ”€â†’ tools/schema.py
        â”‚   â””â”€â†’ agent/safety.py
        â”‚
        â”œâ”€â†’ DatabaseTools (Toolkit)
        â”‚   â””â”€â†’ å››å¤§æ ¸å¿ƒå·¥å…·
        â”‚
        â””â”€â†’ WebSearchTools (Toolkit)
            â””â”€â†’ tools/web_search.py
```

## ğŸš€ ä½¿ç”¨æµç¨‹

1. **é…ç½®**: ç¼–è¾‘ `.env` æ–‡ä»¶æˆ–è¿è¡Œ `python askdb_agno.py setup`
2. **æµ‹è¯•**: è¿è¡Œ `python test_agno_implementation.py`
3. **ä½¿ç”¨**: è¿è¡Œ `python askdb_agno.py interactive`

## ğŸ“Š ä»£ç ç»Ÿè®¡

| æ¨¡å— | æ–‡ä»¶ | è¡Œæ•° | è¯´æ˜ |
|------|------|------|------|
| ä¸»ç¨‹åº | askdb_agno.py | ~500 | Agno Agent å®ç° |
| å·¥å…·é›† | tools/agno_tools.py | ~400 | æ ¸å¿ƒå·¥å…·é›† |
| å®‰å…¨ | agent/safety.py | ~625 | å®‰å…¨ç®¡ç†å™¨ |
| æ•°æ®åº“ | tools/database.py | ~490 | æ•°æ®åº“æ“ä½œ |
| æ¨¡å¼ | tools/schema.py | ~590 | æ¨¡å¼ç®¡ç† |
| æœç´¢ | tools/web_search.py | ~470 | ç½‘ç»œæœç´¢ |
| **æ€»è®¡** | | **~3075** | æ ¸å¿ƒä»£ç  |

ç›¸æ¯”åŸç‰ˆå®ç°ï¼ˆçº¦ 5000+ è¡Œï¼‰ï¼Œä»£ç é‡å‡å°‘çº¦ 40%ã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. ReAct æ¡†æ¶
- âœ… ç”± Agno æ¡†æ¶è‡ªåŠ¨å°è£…
- âœ… Reasoning â†’ Acting â†’ Observation å¾ªç¯
- âœ… è‡ªåŠ¨ SQL è°ƒè¯•å’Œé”™è¯¯æ¢å¤

### 2. å››å¤§æ ¸å¿ƒå·¥å…·ï¼ˆè®ºæ–‡è¦æ±‚ï¼‰
- âœ… execute_query - æ‰§è¡ŒæŸ¥è¯¢
- âœ… execute_non_query - æ•°æ®ä¿®æ”¹
- âœ… search_tables_by_name - è¯­ä¹‰è¡¨æœç´¢
- âœ… request_for_internet_search - ç½‘ç»œæœç´¢

### 3. å¤šå±‚å®‰å…¨åè®®
- âœ… é£é™©åˆ†ç±»å’Œè¯„ä¼°
- âœ… PII æ£€æµ‹å’Œè¿‡æ»¤
- âœ… SQL æ³¨å…¥é˜²æŠ¤
- âœ… ç”¨æˆ·ç¡®è®¤æœºåˆ¶

### 4. åŠ¨æ€æ¨¡å¼æ„ŸçŸ¥
- âœ… å‘é‡ç´¢å¼•åŒ–ï¼ˆall-MiniLM-L6-v2ï¼‰
- âœ… è¯­ä¹‰æœç´¢ç›¸å…³è¡¨
- âœ… Schema-Aware Prompting

## ğŸ“ ç»´æŠ¤å»ºè®®

### éœ€è¦å®šæœŸæ›´æ–°çš„æ–‡ä»¶
1. `requirements.txt` - ä¾èµ–åŒ…ç‰ˆæœ¬
2. `.env` - ç¯å¢ƒé…ç½®
3. `logs/` - å®šæœŸæ¸…ç†æ—¥å¿—

### ä¸è¦ä¿®æ”¹çš„æ ¸å¿ƒæ–‡ä»¶
1. `tools/agno_tools.py` - é™¤éæ·»åŠ æ–°å·¥å…·
2. `agent/safety.py` - å®‰å…¨æ£€æŸ¥é€»è¾‘
3. `askdb_agno.py` - ä¸»ç¨‹åºé€»è¾‘

### å¯ä»¥å®šåˆ¶çš„éƒ¨åˆ†
1. **ç³»ç»Ÿæç¤º**: ç¼–è¾‘ `askdb_agno.py` ä¸­çš„ `instructions`
2. **å®‰å…¨é˜ˆå€¼**: ä¿®æ”¹ `agent/safety.py` ä¸­çš„é£é™©é…ç½®
3. **å·¥å…·è¡Œä¸º**: æ‰©å±• `tools/agno_tools.py` æ·»åŠ æ–°å·¥å…·

## ğŸ” å¿«é€Ÿå®šä½

| éœ€æ±‚ | æ–‡ä»¶ä½ç½® |
|------|---------|
| ä¿®æ”¹ Agent è¡Œä¸º | askdb_agno.py (instructions) |
| æ·»åŠ æ–°å·¥å…· | tools/agno_tools.py |
| è°ƒæ•´å®‰å…¨ç­–ç•¥ | agent/safety.py |
| æ•°æ®åº“é…ç½® | .env æˆ– config/ |
| æŸ¥çœ‹æ—¥å¿— | logs/ |

---

**æœ€åæ›´æ–°**: 2024å¹´
**ç‰ˆæœ¬**: Agno Framework Edition
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

